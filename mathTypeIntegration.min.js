function getImageHTML(e){return`<img align="middle" src="${e.imgSrc}" data-mathml="${e.mathML.replaceAll('"',"'")}" role="math" style="max-width: none; vertical-align: -4px;">`}function closeIframe(e,t){t&&window.removeEventListener("message",t),document.getElementById("mathType-"+e).style.display="none"}function openIFrame(e){var t=document.getElementById("mathType-"+e);t.style.display="block",t.style="bottom: 0px;right: 10px;height: 422px;width: 700px;border: 1px solid lightgrey;background: #fafafa;z-index: 999999;position: fixed;bottom: 3px;right: 3px;box-shadow: rgb(0 0 0 / 16%) 0px 3px 8px 6px;display: block; border-radius: 3%;"}var isPluginCommSet=!1;function setIframeCommunication(e){var t=window.frames["mathType-"+e.id];t.postMessage({action:"setCommunication",data:""},"*"),!function e(a){window.addEventListener("message",function n(i){switch(i.data.action){case"closeIFrame":closeIframe(a.id,n);break;case"openIFrame":openIFrame(a.id);break;case"insertImage":a.insertContent(getImageHTML(i.data.data)),a.contentWindow.document.addEventListener("click",n=>{"img"===n.target.tagName.toLowerCase()&&(t.postMessage({action:"insertMathML",data:`${n.target.getAttribute("data-mathml")}`},"*"),e(a))}),closeIframe(a.id,n)}})}(e)}tinymce.PluginManager.add("MathType",function(e){return closeIframe(e.id),e.ui.registry.addButton("mathtype",{text:"MathType",onAction(){openIFrame(e.id),setIframeCommunication(e)}}),{getMetadata:()=>({name:"MathType plugin"})}});