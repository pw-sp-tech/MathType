function getImageHTML(e){return`<img align="middle" src="${e.imgSrc}" data-mathml="${e.mathML.replaceAll('"',"'")}" role="math" style="max-width: none; vertical-align: -4px;">`}function closeIframe(e){console.log("amlsjkdfasf","mathType-"+e);var t=document.getElementById("mathType-"+e);console.log("mathTypeWindow",t),t.style.display="none"}function openIFrame(e){var t=document.getElementById("mathType-"+e);t.style.display="block",t.style="bottom: 0px;right: 10px;height: 422px;width: 700px;border: 1px solid lightgrey;background: #fafafa;z-index: 999999;position: fixed;bottom: 3px;right: 3px;box-shadow: rgb(0 0 0 / 16%) 0px 3px 8px 6px;display: block; border-radius: 3%;"}var isPluginCommSet=!1;function setIframeCommunication(e){var t=window.frames["mathType-"+e.id];t.postMessage({action:"setCommunication",data:""},"*"),isPluginCommSet||(isPluginCommSet=!0,window.addEventListener("message",a=>{switch(a.data.action){case"closeIFrame":closeIframe(e.id);break;case"openIFrame":openIFrame(e.id);break;case"insertImage":e.insertContent(getImageHTML(a.data.data)),e.contentWindow.document.addEventListener("click",e=>{"img"===e.target.tagName.toLowerCase()&&t.postMessage({action:"insertMathML",data:`${e.target.getAttribute("data-mathml")}`},"*")}),closeIframe(e.id)}}))}tinymce.PluginManager.add("MathType",function(e){return closeIframe(e.id),e.ui.registry.addButton("mathtype",{text:"MathType",onAction(){console.log("editor",e),openIFrame(e.id),setIframeCommunication(e)}}),{getMetadata:()=>({name:"MathType plugin"})}});
